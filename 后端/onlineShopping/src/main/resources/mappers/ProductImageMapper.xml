<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.online_shopping_project.onlineshopping.mapper.ProductImageMapper">

    <resultMap id="ImageMap" type="com.online_shopping_project.onlineshopping.entity.ProductImage">
        <id     column="id"          property="id"/>
        <result column="product_id"  property="productId"/>
        <result column="url"         property="url"/>
        <result column="sort"        property="sort"/>
    </resultMap>
    <!-- 根据商品ID查询图片 -->
    <select id="selectByProductId" resultMap="ImageMap">
        SELECT id, product_id, url, sort
        FROM product_image
        WHERE product_id = #{productId}
        ORDER BY sort ASC, id ASC
    </select>
    <!-- 批量插入图片记录 -->
    <insert id="insertBatch">
        INSERT INTO product_image (product_id, url, sort)
        VALUES
        <foreach collection="urls" item="u" separator=",">
            (#{productId}, #{u}, 0)
        </foreach>
    </insert>
</mapper>
